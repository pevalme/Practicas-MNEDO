\documentclass[nochap]{apuntes}
\title{Métodos numéricos para EDO}
\author{Pedro Valero}
\date{13-10-2015}

% Paquetes adicionales
\usepackage{tikztools}
\usepackage{fastbuild}
\usepackage{booktabs}
\usetikzlibrary{arrows}

\begin{document}
%\maketitle
\pagestyle{plain}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%%         Práctica 1
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Primer apartado}
Una vez programados y ejecutados los métodos mencionados de Adams-Moulton y de Euler con los datos iniciales dados en el enunciado podemos comprobar que la previsión para la humanidad en caso de desatarse el apocalipsis es:

\begin{center}
\begin{tabular}{lccc}    \toprule
Método    & Humanos (S)  & Zombies (Z)  & Muertos infectados (R)  \\ \midrule
Adams-Moulton & $6 \cdot 10^{-6}$ & 239,05 & 262,97\\ 
Euler & $2 \cdot 10^{-6}$ & 239,06 & 262,96\\\bottomrule
 \hline
\end{tabular}
\end{center}

Podemos ver que el resultado es el mismo con ambos métodos, como era de esperar. Hay una mínima diferencia en la cantidad de humanos restante pero no es significativa puesto que es del orden de $10^{-6}$.

El problema que estamos considerando no permite la generación de ningún tipo de criatura de la nada. Por tanto, el número total de individuos se mantiene constante, como puede observarse en los resultados obtenidos.

La suma de individuos que obtenemos no es exactamente 502 (como son los individuos originales) pero dista muy poco y esta diferencia se debe a los errores de redondeo introducidos en cada iteración.

\section{Segundo apartado}

Si al finalizar el día la población de zombies se ve reducida al a mitad, el problema puede modelarse como 10 PVI diferentes (puesto que estamos simulando 10 días)

Con esta modificación obtenemos la siguiente previsión

\begin{center}
\begin{tabular}{lccc}    \toprule
Método    & Humanos (S)  & Zombies (Z)  & Muertos infectados (R)  \\ \midrule
Adams-Moulton & 0,40603 & 1,28712 & 500,99808\\ 
Euler & 3,9881 $\cdot 10^{-1}$ & 9,9956 $\cdot 10^{-2}$ & 5,0268$\cdot 10^2$\\\bottomrule
 \hline
\end{tabular}
\end{center}

lo que supone un futuro mucho más esperanzador para la raza humana.

\section{Tercer apartado}
En esta práctica estamos resolviendo el siguiente PVI:
\[\left\{ \begin{array}{lll}
y_1'& = & -0.0095y_1y_2\\ 
y_2'& = & 0.0095y_1y_2 + 0.0001y_3 - 0.005y_1y_2\\ 
y_3'& = & 0.005y_1y_2-0.0001y_3\\ 
y(0)& = & (500,2,0)  
\end{array}\right.\]

Por tanto, la función con la que estamos trabajando es:
\[f(x,y)=(-0.0095y_1y_2,0.0095y_1y_2 + 0.0001y_3 - 0.005y_1y_2,0.005y_1y_2-0.0001y_3)\]

Es evidente que esta función es continua puesto que cada coordenada no es más que un polinomio. Veamos si es o no Lipschitz en la segunda variable.

\[\norm{f(x,y)-f(x,\tilde{y})} =\norm{\left(0.0095(y_1y_2-\tilde{y}_1\tilde{y}_2), 0.0045(y_1y_2-\tilde{y}_1\tilde{y}_2) + 0.0001(y_3-\tilde{y}_3),\atop0.005(y_1y_2-\tilde{y}_1\tilde{y}_2)-0.0001(y_3-\tilde{y}_3) \right)}=\]
\[=\sqrt{0.0095^2(y_1y_2-\tilde{y}_1\tilde{y}_2)^2 + \left(0.0045(y_1y_2-\tilde{y}_1\tilde{y}_2) + 0.0001(y_3-\tilde{y}_3) \right)^2 + \atop \left(0.005(y_1y_2-\tilde{y}_1\tilde{y}_2)-0.0001(y_3-\tilde{y}_3)\right)^2}=\]

\[=\sqrt{1.3 \cdot 10^{-4}(y_1y_2-\tilde{y}_1\tilde{y}_2)^2 + 2\cdot 10^{-8} (y_3-\tilde{y}_3)^2 + 1\cdot 10^{-7} (y_3-\tilde{y}_3)(y_1y_2-\tilde{y}_1\tilde{y}_2)} \]

Es sencillo ver que la función no es globalmente Lipschitz. Para ello basta con tomar:
\[\begin{array}{l}y_1, y_2 < 0, y_3 \in \real \\
\tilde{y}_1 = y_1 + ε, \tilde{y}_2 = y_2 + δ, \tilde{y}_3 = y_3\end{array} \implies \norm{f(x,y)-f(x,\tilde{y})} = 0.011(-y_1δ-y_2ε+εδ)\]

Si la función fuese Lipschitz tendríamos que 
\[ 0.011(-y_1δ-y_2ε+εδ) \leq C \sqrt{ε^2+δ^2}\]
pero es sencillo ver que esto es imposible puesto que ε y δ serán tan pequeños como deseemos y ``constantes'' mientras que $y_1,y_2$ pueden hacerse tan grandes como queramos.

No obstante, el problema particular sobre el que estamos trabajando, parte de la necesidad de que $y_i>0$, puesto que estamos contando número de individuos, por lo que no tiene sentido un valor negativo.

Además, los valores de $y$ que tomemos no serán tres datos cualesquiera, sino que deberán mantener una relación y es que sus coordenadas siempre sumen lo mismo que las coordenadas del dato inicial.

Así, en el mismo ejemplo que nos ha dado el error en este caso, deberíamos escribir:
\[\begin{array}{l}y_1, y_2 > 0, y_3 \in \real^+ \\
\tilde{y}_1 = y_1 + ε, \tilde{y}_2 = y_2 -ε, \tilde{y}_3 = y_3\end{array} \implies \norm{f(x,y)-f(x,\tilde{y})} = 0.011(y_1ε-y_2ε+ε^2)\]
con lo que tendríamos:
\[0.011(ε^2+ε(y_1-y_2)) \leq 0.11(ε^2+ε(DI))\leq Cε = C\sqrt{ε^2+ε^2}\]
donde $DI$ es la suma de las coordenadas del dato inicial.

Veamos ahora el caso general.

\[\norm{f(x,y)-f(x,\tilde{y})} = \sqrt{0.0095^2(y_1y_2-\tilde{y}_1\tilde{y}_2)^2 + \left(0.0045(y_1y_2-\tilde{y}_1\tilde{y}_2) + 0.0001(y_3-\tilde{y}_3) \right)^2 + \atop \left(0.005(y_1y_2-\tilde{y}_1\tilde{y}_2)-0.0001(y_3-\tilde{y}_3)\right)^2} \leq \]

\[\leq α_1\abs{(y_1y_2-\tilde{y}_1\tilde{y}_2)} + \abs{α_2(y_1y_2-\tilde{y}_1\tilde{y}_2) + α_3(y_3-\tilde{y}_3)} + \abs{α_4(y_1y_2-\tilde{y}_1\tilde{y}_2)-α_5(y_3-\tilde{y}_3)} \leq \]

\[\leq α_1\abs{y_1y_2-\tilde{y}_1\tilde{y}_2} + α_2\abs{y_1y_2-\tilde{y}_1\tilde{y}_2} + α_3\abs{y_3-\tilde{y}_3} + α_4\abs{y_1y_2-\tilde{y}_1\tilde{y}_2}+α_5\abs{y_3-\tilde{y}_3} \]

Por otro lado podemos ver que, siendo
\[\begin{array}{ll} 
\tilde{y}_1 = y_1 \pm a & \implies a =\abs{y_1-\tilde{y}_1}< 1\\
\tilde{y}_2 = y_2 \pm b & \implies b=\abs{y_2-\tilde{y}_2} < 1\\
\tilde{y}_3 = y_3 \pm c & \implies c=\abs{y_3-\tilde{y}_3} < 1
\end{array}\]
podemos escribir:
\[\abs{y_1y_2-\tilde{y}_1\tilde{y}_2} = \abs{\pm ab \pm y_1b \pm y_2 a} \leq \abs{ab}+\abs{y_1}b + \abs{y_2}a\]
y, puesto que las $y_i$ han de tener suma constante igual a 500 y ser positivas, es sencillo ver que $y_i<500$.

Por tanto llegamos a:
\[\abs{y_1y_2-\tilde{y}_1\tilde{y}_2} \leq ab+β_1a + β_2b \leq a+β_1a + β_2b\]
donde la última desigualdad se deriva del hecho de que estamos considerando errores pequeños, menores que 1.

Finalmente, volviendo a nuestra desigualdad para la diferencia de las $f$ tenemos:
\[\norm{f(x,y)-f(x,\tilde{y})}  \leq (a+β_1a+β_2b)(α_1+α_2+α_4) + c(α_3+α_5)\]
donde todas las constantes son mayores que 0. Finalmente, agrupando términos tenemos:
\[\norm{f(x,y)-f(x,\tilde{y})} \leq K(a+b+c) \text{ con } k =\max\{α_1+α_2+α_4+β_1,α_1+α_2+α_4+β_2,α_3+α_5\}\]
que es justo lo que queríamos demostrar para ver que la función es Lipschitz en la segunda variable.
\end{document}
